-- Мини-скрипт для автоматической прокачки Worthiness и использования стрелы/роки
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")

local isEnabled = true
local isMinimized = false

-- Функция проверки и прокачки Worthiness
local function checkAndUpgradeWorthiness()
    local character = LocalPlayer.Character
    if not character then return end
    
    local remoteFunction = character:FindFirstChild("RemoteFunction")
    if not remoteFunction then return end
    
    pcall(function()
        remoteFunction:InvokeServer("LearnSkill", {
            ["Skill"] = "Worthiness",
            ["SkillTreeType"] = "Character"
        })
    end)
end

-- Функция использования стрелы и роки
local function useArrowAndRoka()
    if not isEnabled then return end
    
    local character = LocalPlayer.Character
    if not character then return end
    
    local backpack = LocalPlayer.Backpack
    
    -- Берем стрелу в руку
    local arrow = backpack:FindFirstChild("Mysterious Arrow") or backpack:FindFirstChild("Stand Arrow")
    if arrow then
        character.Humanoid:EquipTool(arrow)
        task.wait(1)
        
        -- Активируем стрелу
        if character:FindFirstChild(arrow.Name) then
            character[arrow.Name]:Activate()
            task.wait(2)
            
            -- Призываем стенд после использования стрелы
            local remoteFunction = character:FindFirstChild("RemoteFunction")
            if remoteFunction then
                pcall(function()
                    remoteFunction:InvokeServer("ToggleStand", "Toggle")
                end)
            end
            
            task.wait(1)
            
            -- Берем року в руку
            local roka = backpack:FindFirstChild("Rokakaka")
            if roka then
                character.Humanoid:EquipTool(roka)
                task.wait(1)
            end
        end
    end
end

-- Основная функция после респавна
local function onRespawn()
    if not isEnabled then return end
    
    task.wait(2) -- Ждем полной загрузки персонажа
    
    -- Прокачиваем Worthiness
    pcall(checkAndUpgradeWorthiness)
    
    task.wait(1)
    
    -- Используем стрелу и року
    pcall(useArrowAndRoka)
end

-- Создаем GUI
local function createControlGUI()
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "AutoWorthinessGUI"
    ScreenGui.Parent = LocalPlayer.PlayerGui
    ScreenGui.ResetOnSpawn = false

    local MainFrame = Instance.new("Frame")
    MainFrame.Size = UDim2.new(0, 250, 0, 100)
    MainFrame.Position = UDim2.new(0, 10, 0, 150)
    MainFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
    MainFrame.BorderSizePixel = 0
    MainFrame.Active = true
    MainFrame.Draggable = true
    MainFrame.Parent = ScreenGui

    local Corner = Instance.new("UICorner")
    Corner.CornerRadius = UDim.new(0, 6)
    Corner.Parent = MainFrame

    -- Заголовок
    local TitleBar = Instance.new("Frame")
    TitleBar.Size = UDim2.new(1, 0, 0, 25)
    TitleBar.Position = UDim2.new(0, 0, 0, 0)
    TitleBar.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    TitleBar.Parent = MainFrame

    local TitleText = Instance.new("TextLabel")
    TitleText.Size = UDim2.new(0.7, 0, 1, 0)
    TitleText.Position = UDim2.new(0, 5, 0, 0)
    TitleText.BackgroundTransparency = 1
    TitleText.Text = "ARROWROKA HELPER"
    TitleText.TextColor3 = Color3.fromRGB(200, 200, 200)
    TitleText.Font = Enum.Font.GothamBold
    TitleText.TextSize = 12
    TitleText.TextXAlignment = Enum.TextXAlignment.Left
    TitleText.Parent = TitleBar

    -- Кнопка сворачивания
    local MinimizeButton = Instance.new("TextButton")
    MinimizeButton.Size = UDim2.new(0, 20, 0, 20)
    MinimizeButton.Position = UDim2.new(1, -50, 0.5, -10)
    MinimizeButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    MinimizeButton.TextColor3 = Color3.fromRGB(200, 200, 200)
    MinimizeButton.Font = Enum.Font.GothamBold
    MinimizeButton.TextSize = 12
    MinimizeButton.Text = "-"
    MinimizeButton.Parent = TitleBar

    local MinimizeCorner = Instance.new("UICorner")
    MinimizeCorner.CornerRadius = UDim.new(0, 4)
    MinimizeCorner.Parent = MinimizeButton

    -- Кнопка закрытия
    local CloseButton = Instance.new("TextButton")
    CloseButton.Size = UDim2.new(0, 20, 0, 20)
    CloseButton.Position = UDim2.new(1, -25, 0.5, -10)
    CloseButton.BackgroundColor3 = Color3.fromRGB(170, 0, 0)
    CloseButton.TextColor3 = Color3.fromRGB(200, 200, 200)
    CloseButton.Font = Enum.Font.GothamBold
    CloseButton.TextSize = 12
    CloseButton.Text = "X"
    CloseButton.Parent = TitleBar

    local CloseCorner = Instance.new("UICorner")
    CloseCorner.CornerRadius = UDim.new(0, 4)
    CloseCorner.Parent = CloseButton

    -- Контент фрейм (все кнопки внутри него)
    local ContentFrame = Instance.new("Frame")
    ContentFrame.Size = UDim2.new(1, 0, 1, -25)
    ContentFrame.Position = UDim2.new(0, 0, 0, 25)
    ContentFrame.BackgroundTransparency = 1
    ContentFrame.Parent = MainFrame

    -- Кнопка остановки
    local StopButton = Instance.new("TextButton")
    StopButton.Size = UDim2.new(0.8, 0, 0, 30)
    StopButton.Position = UDim2.new(0.1, 0, 0.1, 0)
    StopButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    StopButton.TextColor3 = Color3.fromRGB(200, 200, 200)
    StopButton.Font = Enum.Font.GothamBold
    StopButton.TextSize = 12
    StopButton.Text = "ОСТАНОВИТЬ"
    StopButton.Parent = ContentFrame

    local StopCorner = Instance.new("UICorner")
    StopCorner.CornerRadius = UDim.new(0, 4)
    StopCorner.Parent = StopButton

    -- Кнопка продолжения
    local StartButton = Instance.new("TextButton")
    StartButton.Size = UDim2.new(0.8, 0, 0, 30)
    StartButton.Position = UDim2.new(0.1, 0, 0.5, 0)
    StartButton.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    StartButton.TextColor3 = Color3.fromRGB(200, 200, 200)
    StartButton.Font = Enum.Font.GothamBold
    StartButton.TextSize = 12
    StartButton.Text = "ПРОДОЛЖИТЬ"
    StartButton.Parent = ContentFrame

    local StartCorner = Instance.new("UICorner")
    StartCorner.CornerRadius = UDim.new(0, 4)
    StartCorner.Parent = StartButton

    -- Статус
    local StatusLabel = Instance.new("TextLabel")
    StatusLabel.Size = UDim2.new(0.8, 0, 0, 15)
    StatusLabel.Position = UDim2.new(0.1, 0, 0.9, 0)
    StatusLabel.BackgroundTransparency = 1
    StatusLabel.Text = "Статус: АКТИВНО"
    StatusLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
    StatusLabel.Font = Enum.Font.Gotham
    StatusLabel.TextSize = 10
    StatusLabel.Parent = ContentFrame

    -- Функция сворачивания/разворачивания
    local function toggleMinimize()
        if isMinimized then
            -- Разворачиваем
            ContentFrame.Visible = true
            MainFrame.Size = UDim2.new(0, 250, 0, 100)
            MinimizeButton.Text = "-"
            isMinimized = false
        else
            -- Сворачиваем
            ContentFrame.Visible = false
            MainFrame.Size = UDim2.new(0, 250, 0, 25)
            MinimizeButton.Text = "+"
            isMinimized = true
        end
    end

    -- Обработчики кнопок
    StopButton.MouseButton1Click:Connect(function()
        isEnabled = false
        StopButton.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
        StartButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
        StatusLabel.Text = "Статус: ОСТАНОВЛЕНО"
        StatusLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
    end)

    StartButton.MouseButton1Click:Connect(function()
        isEnabled = true
        StopButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
        StartButton.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
        StatusLabel.Text = "Статус: АКТИВНО"
        StatusLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
        
        -- Запускаем процесс сразу при включении
        if LocalPlayer.Character then
            task.spawn(onRespawn)
        end
    end)

    -- Кнопка сворачивания
    MinimizeButton.MouseButton1Click:Connect(function()
        toggleMinimize()
    end)

    -- Кнопка закрытия (выключение скрипта)
    CloseButton.MouseButton1Click:Connect(function()
        isEnabled = false
        ScreenGui:Destroy()
    end)

    return ScreenGui
end

-- Обработчик респавна
LocalPlayer.CharacterAdded:Connect(function(character)
    task.spawn(onRespawn)
end)

-- Создаем GUI
local ControlGUI = createControlGUI()

-- Первая проверка при запуске скрипта
task.wait(5)
if LocalPlayer.Character and isEnabled then
    task.spawn(onRespawn)
end

print("ArrowRoka Helper активирован!")
